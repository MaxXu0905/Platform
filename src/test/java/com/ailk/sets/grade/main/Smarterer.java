package com.ailk.sets.grade.main;import java.io.BufferedReader;import java.io.DataOutputStream;import java.io.IOException;import java.io.InputStreamReader;import java.io.Serializable;import java.net.HttpURLConnection;import java.net.URL;import java.util.ArrayList;import java.util.List;import javax.net.ssl.HttpsURLConnection;import net.sf.json.JSONArray;import net.sf.json.JSONObject;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.context.support.ClassPathXmlApplicationContext;import org.springframework.stereotype.Service;import org.springframework.transaction.annotation.Transactional;import com.ailk.sets.grade.dao.intf.IQbSmartererDao;import com.ailk.sets.grade.jdbc.QbSmarterer;@Transactional(rollbackFor = Exception.class)@Servicepublic class Smarterer {	private static final String POST_URL = "http://smarterer.com/tests/%s/run";	// 需要手动粘贴的内容：	private static String COOKIE = "session_id=b0f682f630be11e4a8fe22000b4606be; last_home_page=home; __utma=136897842.1071829117.1409444369.1409444369.1409449022.2; __utmb=136897842.239.10.1409449022; __utmc=136897842; __utmz=136897842.1409444369.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none); mp_5d14d8e5affa44402ce0520146afefc1_mixpanel=%7B%22is_logged_in%22%3A%20true%2C%22username%22%3A%20%22qwefdasf%22%2C%22homepage_version%22%3A%20%22v1%22%2C%22distinct_id%22%3A%20%22b0f682f630be11e4a8fe22000b4606be%22%2C%22%24initial_referrer%22%3A%20%22%24direct%22%2C%22%24initial_referring_domain%22%3A%20%22%24direct%22%2C%22experiment%3A%20sign%20up%22%3A%20%22control%22%2C%22mp_name_tag%22%3A%20%22xxxx%20xxx%20%23b0f682f630be11e4a8fe22000b4606be%22%2C%22days_old%22%3A%20%220%22%2C%22aquisition_channel%22%3A%20%22Organic%22%7D";	@Autowired	private IQbSmartererDao qbSmartererDao;	private static final String TIDS[] = { "practice_question",			"practice_question_answered_timed_out",			"practice_question_answered", "these_questions_count", "question",			"question_answered_timed_out", "question_answered",			"out_of_questions", "bonus_intro", "bonus_question",			"bonus_question_answered_timed_out", "bonus_question_answered" };	private static final int TYPE_PRACTICE_QUESTION = 0;	private static final int TYPE_PRACTICE_QUESTION_ANSWERED_TIMED_OUT = 1;	private static final int TYPE_PRACTICE_QUESTION_ANSWERED = 2;	private static final int TYPE_THESE_QUESTIONS_COUNT = 3;	private static final int TYPE_QUESTION = 4;	private static final int TYPE_QUESTION_ANSWERED_TIMED_OUT = 5;	private static final int TYPE_QUESTION_ANSWERED = 6;	private static final int TYPE_OUT_OF_QUESTIONS = 7;	private static final int TYPE_BONUS_INTRO = 8;	private static final int TYPE_BONUS_QUESTION = 9;	private static final int TYPE_BONUS_QUESTION_ANSWERED_TIMED_OUT = 10;	private static final int TYPE_BONUS_QUESTION_ANSWERED = 11;	@SuppressWarnings("serial")	public static class Response implements Serializable {		private String tid;		private int percentCorrect;		private int percentIncorrect;		private String question;		private int answer;		private int totalResponses;		private String difficulty;		private long questionId;		private List<String> options;		public String getTid() {			return tid;		}		public void setTid(String tid) {			this.tid = tid;		}		public int getPercentCorrect() {			return percentCorrect;		}		public void setPercentCorrect(int percentCorrect) {			this.percentCorrect = percentCorrect;		}		public int getPercentIncorrect() {			return percentIncorrect;		}		public void setPercentIncorrect(int percentIncorrect) {			this.percentIncorrect = percentIncorrect;		}		public String getQuestion() {			return question;		}		public void setQuestion(String question) {			this.question = question;		}		public int getAnswer() {			return answer;		}		public void setAnswer(int answer) {			this.answer = answer;		}		public int getTotalResponses() {			return totalResponses;		}		public void setTotalResponses(int totalResponses) {			this.totalResponses = totalResponses;		}		public String getDifficulty() {			return difficulty;		}		public void setDifficulty(String difficulty) {			this.difficulty = difficulty;		}		public long getQuestionId() {			return questionId;		}		public void setQuestionId(long questionId) {			this.questionId = questionId;		}		public List<String> getOptions() {			return options;		}		public void setOptions(List<String> options) {			this.options = options;		}	}	public static void main(String[] args) {		ClassPathXmlApplicationContext context = new ClassPathXmlApplicationContext(				new String[] { "/spring/beans.xml", "/spring/localbean.xml" });		context.start();		Smarterer instance = context.getBean(Smarterer.class);		final String[] bankInfos = { "software-testing", "basic-networking",				"javascript-dom", "haskell", "clojure", "microsoft-sql-server",				"cakephp", "bash", "english-spelling-and-grammar",				"us-english-proofreading-chicago", "article-writing",				"academic-writing", "postgresql", "sentence-structure",				"english-vocabulary-uk", "outlook", "uk-english-basics",				"ubuntu", "access", "windows-8", "quickbooks", "acrobat",				"vba", "tableau-desktop", "anylogic-6", "pdf-forms",				"basic-math", "powerpoint", "opengl", "samba",				"google-maps-api", "technical-aptitude",				"microsoft-mvc-framework",				"google-chrome-keyboard-shortcuts-mac", "tweetdeck",				"installshield", "yola", "printout", "adobe-framemaker",				"ibm-lombardi", "camtasia-studio", "vlc-media-player",				"mozilla-thunderbird", "byword-keyboard-shortcuts-mac",				"spanish-english-translation", "transcription",				"report-writing", "google-adwords", "google-analytics", "sem",				"facebook", "constant-contact", "twitter", "scvngr",				"financial-statements", "statistics-and-probability",				"financial-reporting", "financial-forecasting",				"medical-billing", "corporate-finance",				"data-structures-and-algorithms", "amazon-web-services",				"django", "active-directory", "salesforce-development",				"symfony2", "firewall-concepts",				"blackberry-native-sdk-development", "ebay-development",				"paypal-development", "lamp", "google-glass-development",				"windows-vista-administration", "wordpress-for-html-guys",				"va-html-xss-assessment", "yii1x", "boxnet" };		/*		 * final String[] bankInfos = { "english-for-business",		 * "project-management", "customer-service-call-center-env",		 * "networking", "press-releases", "market-research", "travel-planning",		 * "human-resource-management", "entrepreneur-challenge", "cisco",		 * "operational-maturity-tools", "gamification",		 * "pmp-project-management", "english-language",		 * "administrative-assistant", "customer-service", "graphic-designer",		 * "telephone-etiquette", "business-writing", "email-handling",		 * "time-management", "event-planning", "financial-accounting",		 * "presentation-skills", "people-management", "accounts-payable",		 * "business-strategy", "business-planning", "analytics",		 * "spelling-for-business", "accounts-receivable", "payroll",		 * "negotiation", "public-speaking", "management-accounting",		 * "organizational-behavior", "corporate-communications-test",		 * "corporate-strategy", "salesforce-crm", "grammar-for-business",		 * "office-administration", "enterprise-resource-planning-erp", "visio",		 * "product-management", "iso-9001", "federal-income-tax",		 * "pc-hardware", "financial-instruments", "six-sigma-black-belt",		 * "lean-startup-methodology", "ecommerce", "ap-style",		 * "investment-banking-fundamentals", "sales-benchmark-index",		 * "strategic-management", "beginner-spanish", "sarbanes-oxley",		 * "financial-times-worldwise", "basic-recruiter-certification",		 * "occupation-vocabulary", "inventory-management", "corporate-law",		 * "real-estate", "business-analysis-fundamentals", "commodity-futures",		 * "startups", "business-ethics", "data-entry",		 * "strategic-human-resource-management", "the-seed-stage-market",		 * "venture-capital-fundamentals", "airline-knowledge",		 * "hiring-an-army-of-interns", "building-high-performing-tech-teams",		 * "aviation-safety-management-systems",		 * "people-performance-management", "team-work", "inside-sales-rep",		 * "b2b-marketing", "itil", "health-insurance-domain-expertise",		 * "total-quality-management", "ogsm-framework", "netsuite",		 * "pmp-test-ima", "mikrotik", "thredup-warehouse-associate",		 * "asperity-business-english", "dimensional-modelling",		 * "mortgage-banking", "debt-collection-skills-test",		 * "student-loans-101", "college-financial-aid", "comptia-a%2B",		 * "policy-analysis", "insurance-101", "comptia-network%2B",		 * "principales-aportes-de-la-administracion", "chief-architect",		 * "photoshop", "css", "logo-design", "adobe-lightroom",		 * "autodesk-maya", "cinema-4d", "fireworks",		 * "axure-rp-rapid-prototype-tool", "lightwave", "html", "illustrator",		 * "indesign", "after-effects", "3d-modeling", "video-editing",		 * "typography", "premiere-pro", "dreamweaver", "coreldraw",		 * "animation", "autodesk-3ds-max", "blender", "sketchup", "pro-tools",		 * "gimp", "omnigraffle", "zbrush", "archicad", "rhinoceros-3d",		 * "design-principles", "motion-graphics", "less", "balsamiq",		 * "making-presentations-that-change-minds-interlligently-class",		 * "edifixio-css", "video-production", "advance-logo-design",		 * "enterprise-gamification", "eyeon-fusion", "autodesk-mudbox",		 * "articulate-storyline", "bridge", "sidefx-houdini",		 * "artlantis-studio-4", "adobe-captivate", "photoshop-cs5",		 * "microsoft-blend-for-visual-studio", "html5", "css3", "photography",		 * "final-cut-pro", "flash", "quarkxpress", "imovie",		 * "final-cut-express", "excel", "vmware", "project", "sap",		 * "dvd-studio-pro", "computer-competency-test", "windows-7", "outlook",		 * "access", "windows-8", "quickbooks", "acrobat", "red-hat-linux",		 * "vba", "tableau-desktop", "solaris", "google-chrome", "camtasia",		 * "zoho-creator", "windows-xp", "osx", "skype-user", "anylogic-6",		 * "pdf-forms", "apple-mail", "truecrypt", "ios-5-ipad-and-iphone",		 * "keynote", "ubuntu", "google-chrome-keyboard-shortcuts-mac",		 * "tweetdeck", "installshield", "yola", "printout", "setup-factory",		 * "adobe-framemaker", "ibm-lombardi", "camtasia-studio",		 * "vlc-media-player", "mozilla-thunderbird",		 * "byword-keyboard-shortcuts-mac", "cmd-windows", "netvault-backup",		 * "iphoto", "linux", "unix", "firefox", "dropbox", "garageband",		 * "lotus-notes-and-domino", "itunes", "arcgis", "idvd", "ccna",		 * "software-quality-assurance", "semiconductors", "inventor",		 * "mathcad", "orcad-pcb-designer", "orcad-capture", "audio-editing",		 * "data-mining", "mechanical-engineering", "solidworks", "wi-fi",		 * "circuit-design", "analog-electronics", "material-engineering",		 * "system-analysis", "integrated-circuits",		 * "linux-administration-general-knowledge", "revit", "science",		 * "ibm-san-volume-controller-svc", "gothic-architecture",		 * "biologie-marine", "amplifiers-and-filters",		 * "gas-and-oil-engineering", "sip", "arduino-microcontrollers",		 * "arcane-unix-geekery", "automotive-industry-knowledge",		 * "info-security-awareness", "mining-engineering",		 * "8051-microcontroller", "transformers", "proyectos", "autocad",		 * "matlab", "spss", "editing-copyediting",		 * "french-english-translation", "journalism",		 * "german-english-translation", "creative-writing", "english-spelling",		 * "english-grammar", "english-spelling-uk",		 * "english-spelling-and-grammar", "article-writing",		 * "us-english-proofreading-chicago", "academic-writing",		 * "sentence-structure", "english-vocabulary-uk", "uk-english-basics",		 * "spanish-english-translation", "transcription", "report-writing",		 * "understanding-differences-in-british-and-american-english",		 * "resume-writing", "ghostwriting", "technical-writing",		 * "medical-transcription", "basic-french-grammar-and-vocabulary",		 * "tagalog-english-translation", "russian-english-translation",		 * "grant-writing", "fran-ais", "espanol", "german-vocabulary-fruits",		 * "japanese", "intermediate-spanish", "mla-style",		 * "spanish-vocabulary", "ama-style", "interpreting", "chinese",		 * "apa-style", "deutsch-1", "french-numbers",		 * "english-cs-transcription", "english-vocabulary-us-version",		 * "beginner-portuguese-grammar-and-vocabulary", "dewey-decimal-system",		 * "writer", "english-italian-translation",		 * "english-korean-translation",		 * "english-proofreading-oxford-guide-to-style", "italiano-di-base",		 * "investigacion-educativa",		 * "design-psychology-motivate-your-user-intelligently-class",		 * "di-writing-style", "intermediate-ukrainian-grammar",		 * "hebrew-vocabulary", "arabic-language-basic",		 * "thai-english-translation", "democracy-international-writing-style",		 * "web-design", "facebook-marketing", "blogging-best-practices",		 * "advertising", "email-marketing", "google-adwords",		 * "google-analytics", "sem", "facebook", "constant-contact", "twitter",		 * "bing-ads", "adobe-analytics-standard", "eloqua", "seo",		 * "social-media-marketing", "email-etiquette", "copywriting",		 * "internet-online-marketing", "branding", "public-relations",		 * "marketing-analytics", "twitter-marketing", "civil-engineering",		 * "social-media", "affiliate-marketing", "google-adsense",		 * "display-ads", "skype-development", "search-engine-optimisation-seo",		 * "social-recruiting-basics",		 * "the-ultimate-landing-page-intelligently-class",		 * "marketing-associate", "digital-marketing-lmg", "hubspot", "basic",		 * "customer-segmentation-intelligently-class", "hootsuite", "0f393eaa",		 * "huy", "content-marketing-from-content-to-customer", "wiggio",		 * "tooltwist", "the-future-of-marketing", "amazon", "drupal-614",		 * "abcd-1234", "opentable", "bullhorn-live-customer-conference-quiz",		 * "ppc-test", "common-core-k-6-ela", "bcv-faqs",		 * "hvor-god-er-du-til-engelsk", "customer-development",		 * "content-marketing-world-2012",		 * "paid-search-specialist-propertyhark", "games", "kenleejstesten",		 * "intelligently-google-adwords-with-patrick-campbell", "etsy",		 * "robots", "windows-81", "pares-craneales",		 * "aspen-student-information-system", "testllllll", "qainfoo",		 * "theory-of-constraints", "virtualization-and-high-availability",		 * "oracle-e-business-suite", "c%2B%2B-demo-test",		 * "common-core-math-k-6", "mfjlabs-5-star-client-service",		 * "freelancer-quiz", "86e4eed5", "surveymonkey", "linkedin", "youtube",		 * "google%2B", "video-marketing", "icontact", "bzzagent",		 * "mobile-marketing", "blogger", "foursquare", "tumblr", "scvngr",		 * "financial-statements", "statistics-and-probability",		 * "macroeconomics", "microeconomics", "bookkeeping",		 * "financial-analysis",		 * "generally-accepted-accounting-principles-gaap",		 * "financial-reporting", "financial-forecasting", "medical-billing",		 * "basic-math", "corporate-finance", "estimation-test",		 * "emprestimo-para-negativado", "mathmatics", "auditing", "stata",		 * "advanced-mathematics", "basic-algebra-skills", "calculus",		 * "geometry", "mergers-and-acquisitions", "matematica",		 * "basic-mathematics", "mathematical-conversions", "bitcoin",		 * "common-core-7-12-math", "ifrs", "history-of-physical-science",		 * "triangulos", "mathematica", "cfa-level-1-quantitative-methods",		 * "business-mathematics", "cuadrados", "trading-options",		 * "fix-protocol", "r", "bloomberg", "calc", "mobile-app-design",		 * "windows-phone-development", "android-user", "iphone-os-4-user",		 * "ipad", "flexkom-101", "ios-6-technical-basics", "staff-test",		 * "windows-phone-7", "music-theory", "ableton-live", "music-industry",		 * "musica-conceptos", "indian-music", "renoise", "powerpoint", "word",		 * "computer-technician", "medical-terminology",		 * "general-keyboard-shortcuts", "microsoft-dynamics-ax",		 * "google-apps-for-business", "basic-clerical-skills",		 * "common-abbreviations", "basic-mac-google-for-medeo", "yardi",		 * "lasercyte", "impress", "onenote", "php", "javascript",		 * "ios-technical-test", "core-java", "aspnet", "objective-c", "dotnet",		 * "basic-networking", "microsoft-sql-server", "technical-aptitude",		 * "microsoft-mvc-framework", "software-testing",		 * "data-structures-and-algorithms", "amazon-web-services", "xml",		 * "django", "active-directory", "nodejs", "jsp-and-servlets",		 * "salesforce-development", "xhtml", "symfony2", "cakephp", "ruby",		 * "firewall-concepts", "blackberry-native-sdk-development", "mongodb",		 * "hibernate", "ebay-development", "postgresql", "opengl", "samba",		 * "javascript-18", "extjs-4x", "scala",		 * "prototypejs-javascript-framework", "scrapy", "adobe-coldfusion",		 * "windows-azure-developer", "activex-data-objects-ado", "apache-cxf",		 * "wordpress-user", "php5", "mysql", "c", "android-developer", "sql",		 * "ruby-on-rails", "facebook-development", "drupal", "oops-concepts",		 * "json", "tcp-ip", "internet-security", "introduction-to-prgramming",		 * "google-maps-api", "paypal-development", "lamp", "visual-basic",		 * "google-webmaster-central", "dos", "sencha", "vbnet",		 * "restful-services", "apache", "angular-js", "web-developer",		 * "phonegap", "antispam-and-antivirus", "oracle", "dhtml", "spring",		 * "twitter-development", "responsive-web-design", "data-warehousing",		 * "perl", "actionscript-3", "html-401", "wordpress-plugin-development",		 * "google-app-engine", "google-web-toolkit",		 * "cocoa-programming-for-mac-os-x", "rss-20", "jdbc", "my-test",		 * "software-engineering-concepts", "bash", "google-glass-development",		 * "windows-vista-administration", "vim", "apache-flex", "php-quiz",		 * "enterprise-java-beans-ejb", "haskell", "codeigniter",		 * "systems-programming", "clojure", "wordpress-for-html-guys",		 * "javascript-dom", "va-html-xss-assessment", "yii1x", "boxnet",		 * "db2-programming", "db2-administration", "sass", "sap-abap",		 * "do-you-really-know-agile", "c%2B%2B-for-beginners",		 * "linux-sys-admin-aws", "zend-framework",		 * "software-quality-assurance-engineer", "selenium", "backbonejs",		 * "rdf", "apache-tika", "python-workshop",		 * "intelligently-agile-for-startups-with-abby-fichtner",		 * "javascript-code", "phpunit", "linux-bash", "mobile-web-authoring",		 * "india-assessment", "bioinformatics",		 * "web-application-penetration-testing", "apache-poi",		 * "internet-explorer", "sql-server-reporting-services",		 * "digital-forensics", "sublime-text", "machine-learning",		 * "pivotal-tracker", "istqb-foundation-exam", "emmet-zen-coding",		 * "glsl", "swift", "pods-framework", "apache-nutch",		 * "windows-networking-infrastructure", "introduccion-programacion",		 * "software-concepts", "microsoft-silverlight", "ios-jailbreaking",		 * "twisted", "human-computer-interaction",		 * "windows-communication-foundation", "data-modeling",		 * "design-patterns", "svn",		 * "rapid-prototyping-with-google-app-engine-and-bootstrap-intelligently-class"		 * , "cissp", "jee-j2ee", "quicktest-pro", "delphi-xe", "sas",		 * "ibm-worklight-503", "laravel", "java-me", "java-engineer", "twig",		 * "gamemaker", "tapestry5", "opengl-es", "zurb-foundation-4", "qml",		 * "voice-over-ip", "big-data", "emacs", "cakephp-%2B-php-advanced",		 * "powershell", "game-programming-concepts", "koctest",		 * "visual-studio", "regex", "wpf", "redis", "compiler-design",		 * "groovy", "mercurial", "pkgbuild", "dnn-dot-net-nuke", "com",		 * "mnogosearch", "viruses", "jquery", "java", "c%23", "python",		 * "c%2B%2B", "git", "business-development", "outbound-sales",		 * "sales-fundamentals", "mattress-sales", "arc-booking", "pinterest",		 * "xeeme", "redes-sociales-en-espanol", "executable-english",		 * "yahoo-messenger", "ziv", "buffertest", "seguridad-infantil",		 * "bullying", "deviantart", "gowalla", "child-safety", "first-aid",		 * "mathematics", "nutrition", "sentiment-analysis",		 * "help-desk-technician", "ufology",		 * "linux-and-networking-fundamentals", "basic-electricity",		 * "test-for-test-analyst", "deliver-now", "communication-specialist",		 * "medical-billing-and-coding", "the-human-body", "greece", "sangre",		 * "information-security-rit-digital-self-defense",		 * "fora-test-how-to-create", "homebrewing", "precipitation",		 * "li-student-advisor", "symbolic-logic", "particle-physics",		 * "neuroscience", "common-lab-values", "videography", "sprout-social",		 * "genetics-and-molecular-biology", "cisionpoint", "lte", "hyper-v",		 * "basic-hydraulics", "college-football-official", "us-culture",		 * "pc-hardware-networking-and-linux", "bible",		 * "ri-educator-evaluation",		 * "hospital-organizations-operations-and-planning",		 * "utest-platform-customers", "gracie-combatives",		 * "problemas-contemporaneos", "american-history", "conspiracies",		 * "classroom-assessment-ric", "waiterpop-certified",		 * "everything-i-need-to-know-about-student-teaching-at-ric",		 * "bacterias", "biologia", "sterile-processing", "hcbf-knowledge",		 * "college-readiness-exam-math", "square",		 * "graphic-designer-assessment", "shenandoah-university-technology",		 * "hadoop-mapreduce", "resumator-knowledge", "express-scribe",		 * "printing-amazon-orders", "centura-sqlwindows",		 * "let-reviewer-part-1", "quimica", "foster-skills-example-test",		 * "rocketseed", "mediafire", "asp", "slideshare", "boomerang",		 * "tweetdeck-for-android", "utest", "infopath", "sugarsync",		 * "quantum-gis", "unity3d", "hubpages", "artrage", "delicious",		 * "drupal-gardens", "base", "maple", "graphicmail", "ibm-blade-center",		 * "microstation", "inkscape", "emc-clariion", "crystal-xcelsius",		 * "typepad", "maplesim", "google-search", "ajax", "magento", "joomla",		 * "ebooks", "ebay", "dojo", "elance", "user-experience", "shopify",		 * "sharepoint", "mailchimp", "exchange-2010",		 * "wordpress-for-non-developers", "modx-revolution", "cpanel-and-whm",		 * "smarterer-test-creation", "test-microsoft-word", "aboutme",		 * "web-accessibility", "prezi", "wordpress-basico", "infusionsoft",		 * "concrete5-block-basics", "linux-cli", "wikipedia", "nginx",		 * "moodle-for-teachers", "web-concepts", "bigcommerce", "help-scout",		 * "lemp-stack", "ranksheet", "weheartit", "cs-cart", "web-standards",		 * "mediawiki", "moocs", "brightcove-publishing-module",		 * "freelancecom-test", "google-chrome-en-espanol", "rocketply",		 * "grooveshark", "freshbooks", "servicenow", "wallshops",		 * "bullhorn-ats", "brightcove-media-module", "peoplesoft-financials",		 * "amazon-ebay-seller", "reddit", "odesk", "concrete5",		 * "redhat-cluster", "gmail", "squidoo", "google-maps", "flickr",		 * "bing", "go-daddy", "digg", "yahoo-search", "wistia", "pixable",		 * "yahoo-groups", "stumbleupon" };		 */		int k = 0;		int size = (bankInfos.length + 9) / 10;		for (int i = k * size; i < (k + 1) * size; i++) {			if (i >= bankInfos.length)				break;			String bankName = bankInfos[i];			int rows = 0;			String url = String.format(POST_URL, bankName);			boolean isFinish = false;			System.out.println(bankName + ": " + rows);			while (!isFinish) {				try {					// 请求答题页面					StringBuilder builder = new StringBuilder();					builder.append("ts=" + (System.currentTimeMillis() / 1000));					builder.append("&action=continue");					String content = post(url, builder.toString());					Response response = parse(content);					System.out.println(content);					switch (getTid(response.getTid())) {					case TYPE_PRACTICE_QUESTION:					case TYPE_QUESTION:					case TYPE_BONUS_QUESTION:						break;					case TYPE_OUT_OF_QUESTIONS:						isFinish = true;						continue;					case TYPE_PRACTICE_QUESTION_ANSWERED:					case TYPE_PRACTICE_QUESTION_ANSWERED_TIMED_OUT:						// sign();						Thread.sleep(5000);						continue;					case TYPE_THESE_QUESTIONS_COUNT:					case TYPE_QUESTION_ANSWERED_TIMED_OUT:					case TYPE_QUESTION_ANSWERED:					case TYPE_BONUS_INTRO:					case TYPE_BONUS_QUESTION_ANSWERED_TIMED_OUT:					case TYPE_BONUS_QUESTION_ANSWERED:					default:						continue;					}					// 提交答题页面					builder.setLength(0);					builder.append("ts=" + (System.currentTimeMillis() / 1000));					builder.append("&choice=0");					content = post(url, builder.toString());					response = parse(content);					System.out.println(content);					switch (getTid(response.getTid())) {					case TYPE_PRACTICE_QUESTION:					case TYPE_THESE_QUESTIONS_COUNT:					case TYPE_QUESTION:					case TYPE_BONUS_INTRO:					case TYPE_BONUS_QUESTION:					default:						continue;					case TYPE_OUT_OF_QUESTIONS:						isFinish = true;						continue;					case TYPE_PRACTICE_QUESTION_ANSWERED_TIMED_OUT:					case TYPE_PRACTICE_QUESTION_ANSWERED:					case TYPE_QUESTION_ANSWERED_TIMED_OUT:					case TYPE_QUESTION_ANSWERED:					case TYPE_BONUS_QUESTION_ANSWERED_TIMED_OUT:					case TYPE_BONUS_QUESTION_ANSWERED:						break;					}					instance.saveOrUpdate(bankName, response);					System.out.println(bankName + ": " + rows);					++rows;				} catch (Exception e) {					e.printStackTrace();					System.out.println("题库：" + bankName);					try {						Thread.sleep(5000);					} catch (Exception e1) {					}				}			}		}		System.exit(1);	}	public void saveOrUpdate(String bankName, Response response) {		QbSmarterer qbSmarterer = new QbSmarterer();		qbSmarterer.setBankName(bankName);		qbSmarterer.setQuestionId(response.getQuestionId());		qbSmarterer.setTitle(response.getQuestion());		for (int i = 0; i < response.getOptions().size(); i++) {			String option = response.getOptions().get(i);			switch (i) {			case 0:				qbSmarterer.setOption1(option);				break;			case 1:				qbSmarterer.setOption2(option);				break;			case 2:				qbSmarterer.setOption3(option);				break;			case 3:				qbSmarterer.setOption4(option);				break;			case 4:				qbSmarterer.setOption5(option);				break;			case 5:				qbSmarterer.setOption6(option);				break;			}		}		qbSmarterer.setAnswer(response.getAnswer());		qbSmarterer.setPercentCorrect(response.getPercentCorrect());		qbSmarterer.setPercentIncorrect(response.getPercentIncorrect());		qbSmarterer.setTotalResponses(response.getTotalResponses());		qbSmarterer.setDifficulty(response.getDifficulty());		qbSmartererDao.saveOrUpdate(qbSmarterer);	}	public static String sign() throws Exception {		String encodedPostData = "User--email=123456789%40qq.com&User--password=123&User--returning=sign_in";		URL url = new URL("https://smarterer.com/sign_in");		HttpsURLConnection connection = null;		BufferedReader reader = null;		try {			connection = (HttpsURLConnection) url.openConnection();			connection.setDoOutput(true);			connection.setDoInput(true);			connection.setRequestMethod("POST");			connection.setUseCaches(false);			connection.setRequestProperty("Content-Type",					"application/x-www-form-urlencoded; charset=UTF-8");			connection.setRequestProperty("X-Requested-With", "XMLHttpRequest");			connection					.setRequestProperty("Accept",							"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8");			connection.setRequestProperty("Accept-Language",					"zh-CN,zh;q=0.8,en;q=0.6");			connection.setRequestProperty("Connection", "keep-alive");			connection.setRequestProperty("Content-Length",					Integer.toString(encodedPostData.getBytes().length));			connection.setRequestProperty("Host", "smarterer.com");			connection.setRequestProperty("Origin", "https://smarterer.com");			connection					.setRequestProperty(							"User-Agent",							"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/37.0.2062.94 Safari/537.36");			DataOutputStream out = new DataOutputStream(					connection.getOutputStream());			out.writeBytes(encodedPostData);			out.flush();			out.close();			// COOKIE = connection.getHeaderField("Set-Cookie");			reader = new BufferedReader(new InputStreamReader(					connection.getInputStream()));			StringBuilder lines = new StringBuilder();			String line;			while ((line = reader.readLine()) != null) {				lines.append(line);			}			return lines.toString();		} finally {			if (reader != null)				reader.close();			if (connection != null)				connection.disconnect();		}	}	public static String post(String urlStr, String encodedPostData)			throws IOException {		URL url = new URL(urlStr);		HttpURLConnection connection = null;		BufferedReader reader = null;		try {			connection = (HttpURLConnection) url.openConnection();			connection.setRequestProperty("Cookie", COOKIE);			connection.setDoOutput(true);			connection.setDoInput(true);			connection.setRequestMethod("POST");			connection.setUseCaches(false);			connection.setRequestProperty("Content-Type",					"application/x-www-form-urlencoded; charset=UTF-8");			connection.setRequestProperty("X-Requested-With", "XMLHttpRequest");			connection					.setRequestProperty("Accept",							"application/json,application/vnd.smarterer.content-v2+json, */*; q=0.01");			connection.setRequestProperty("Accept-Language",					"zh-CN,zh;q=0.8,en;q=0.6");			connection.setRequestProperty("Connection", "keep-alive");			connection.setRequestProperty("Content-Length",					Integer.toString(encodedPostData.getBytes().length));			connection.setRequestProperty("Host", "smarterer.com");			connection.setRequestProperty("Origin", "http://smarterer.com");			connection.setRequestProperty("Referer",					"http://smarterer.com/tests/photoshop/run");			connection					.setRequestProperty(							"User-Agent",							"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/37.0.2062.94 Safari/537.36");			connection.setRequestProperty("X-NewRelic-ID", "UgAOVl9ADAUFVFRb");			DataOutputStream out = new DataOutputStream(					connection.getOutputStream());			out.writeBytes(encodedPostData);			out.flush();			out.close();			// COOKIE = connection.getHeaderField("Set-Cookie");			reader = new BufferedReader(new InputStreamReader(					connection.getInputStream()));			StringBuilder lines = new StringBuilder();			String line;			while ((line = reader.readLine()) != null) {				lines.append(line);			}			return lines.toString();		} finally {			if (reader != null)				reader.close();			if (connection != null)				connection.disconnect();		}	}	private static Response parse(String content) {		Response response = new Response();		try {			JSONArray jsonArray = JSONArray.fromObject(content);			JSONObject jsonObject = (JSONObject) jsonArray.get(0);			response.setTid(jsonObject.getString("tid"));			JSONObject ctx = (JSONObject) jsonObject.get("ctx");			if (ctx != null) {				if (ctx.containsKey("percent_correct")) {					response.setPercentCorrect(Integer.parseInt(ctx							.getString("percent_correct")));				}				if (ctx.containsKey("percent_incorrect")) {					response.setPercentIncorrect(Integer.parseInt(ctx							.getString("percent_incorrect")));				}				if (ctx.containsKey("question")) {					response.setQuestion(ctx.getString("question"));				}				if (ctx.containsKey("answer")) {					response.setAnswer(ctx.getInt("answer"));				}				if (ctx.containsKey("total_responses")) {					response.setTotalResponses(Integer.parseInt(ctx							.getString("total_responses")));				}				if (ctx.containsKey("difficulty")) {					response.setDifficulty(ctx.getString("difficulty"));				}				if (ctx.containsKey("question_id")) {					response.setQuestionId(ctx.getLong("question_id"));				}				if (ctx.containsKey("choices")) {					JSONArray jsonChoices = ctx.getJSONArray("choices");					List<String> options = new ArrayList<String>();					for (int i = 0; i < jsonChoices.size(); i++) {						options.add(jsonChoices.getString(i));					}					response.setOptions(options);				}			}		} catch (Exception e) {			e.printStackTrace();		}		return response;	}	private static int getTid(String tid) {		for (int i = 0; i < TIDS.length; i++) {			if (tid.equals(TIDS[i]))				return i;		}		return -1;	}}